var version="V1.0.14";$(function(){window.localStorage?util.init():($(".ok").fadeOut(300,"linear"),$("#ng").fadeIn(300,"linear"))});class valueStore{constructor(){this.Umami={}}}const store=new valueStore;var util={init:function(){$(window).resize(util.videoresize),$("#bt_fs").fadeIn(300,"linear"),$("#scene_top").fadeIn(300,"linear"),$(".aplayer-icon-lrc").trigger("click"),util.initTips("hitokoto"),util.initTips("studytime"),util.initTips("worldtime"),util.musicset.init(),util.initClickEvent(),util.initStrictMode(),util.initWorldTimer(),util.readstoragetime(),util.initUmami(),util.initParams()},initParams:function(){function t(){util.study()}util.getUrlParams("type")&&ufunction.track(util.getUrlParams("type")),"study"==util.getUrlParams("mode")?(lauched=1,t(),ufunction.track("Study")):"strict"==util.getUrlParams("mode")&&(lauched=2,util.addVisibilityListener(),t(),ufunction.track("Study"))},initClickEvent:function(){$("#bt_fs").on("click",function(){util.fullscreen()}),$("#btt_strict").on("click",function(){util.switchStrictMode()}),$("#btt_start").on("click",function(){util.checkStrictMode()&&util.addVisibilityListener(),util.study()}),$("#btt_setting").on("click",function(){util.menuopen("menu")}),$("#btt_menu_music").on("click",function(){util.musicset.open()}),$("#btt_about").on("click",function(){util.menuopen("about"),util.getUmami.GetAll()}),$("#bt_rest").on("click",function(){util.timerecord.pause(),util.menuopen("rest"),util.getUmami.OnlineUser(),$(".aplayer-pause").trigger("click")}),$("#bt_restclose").on("click",function(){$(".aplayer-play").trigger("click"),util.timerecord.start()}),$("#bt_musicswitch").on("click",function(){$(".aplayer-button").trigger("click")}),$("#about_cover").on("click",function(){$("#about").fadeOut(300,"linear"),$("#about_cover").fadeOut(300,"linear"),$("#scene_top").fadeIn(300,"linear")}),$("#menu_cover").on("click",function(){$("#menu").fadeOut(300,"linear"),$("#menu_cover").fadeOut(300,"linear"),$("#scene_top").fadeIn(300,"linear")})},menuopen:function(t){$("#"+t).fadeIn(300,"linear"),$("#"+t+"_cover").fadeIn(300,"linear"),$("#bt_"+t+"close").on("click",function(){$("#"+t).fadeOut(300,"linear"),$("#"+t+"_cover").fadeOut(300,"linear")})},getUrlParams:function(t){var e=window.location.search.substr(1);if(""==e)return!1;for(var i=e.split("&"),n=0;n<i.length;n++){var o=i[n].split("=");if(o[0]==t)return o[1]}return!1},readMusicconf:function(t){let e=localStorage.getItem("conf_music_"+t);return e},musicset:{init:function(){null!=util.readMusicconf("platform")&&null!=util.readMusicconf("id")||util.musicset.reset(),util.musicset.apply(),$("#btt_platform_netease").on("click",function(){localStorage.setItem("conf_music_platform","netease"),util.musicset.load()}),$("#btt_platform_tencent").on("click",function(){localStorage.setItem("conf_music_platform","tencent"),util.musicset.load()}),$("#btt_platform_kugou").on("click",function(){localStorage.setItem("conf_music_platform","kugou"),util.musicset.load()}),$("#btt_music_reset").on("click",function(){util.musicset.reset()}),$("#btt_music_submit").on("click",function(){util.musicset.apply()}),$("input").on("input",function(){var t=$(this).val().replace(/[^\d]/g,"");localStorage.setItem("conf_music_id",t),util.musicset.load()})},load:function(){switch($("#musicconf").fadeOut(50,"linear"),util.readMusicconf("platform")){case"netease":$("#nowplatform").text("网易云音乐");break;case"tencent":$("#nowplatform").text("QQ音乐");break;case"kugou":$("#nowplatform").text("酷狗音乐")}$("#nowid").text(util.readMusicconf("id")),$("input").attr("value",util.readMusicconf("id")),$("input").val(util.readMusicconf("id")),$("#musicconf").fadeIn(50,"linear")},open:function(){$("#music").fadeIn(300,"linear"),$("#top_cover").fadeIn(300,"linear"),$("#bt_musicclose").on("click",function(){$("#music").fadeOut(300,"linear"),$("#top_cover").fadeOut(300,"linear")})},reset:function(){localStorage.setItem("conf_music_platform","netease"),localStorage.setItem("conf_music_id","8611769328"),util.musicset.load(),util.musicset.apply()},apply:function(){util.musicset.load(),$("meting-js").remove(),$("#bt_fs").after('<meting-js server="'+util.readMusicconf("platform")+'" type="playlist" id='+util.readMusicconf("id")+' fixed="true" theme="#39c5bb" order="random" mutex="true" lrc-type="0"> </meting-js>'),util.AplayerInteraction()}},AplayerInteraction:async function(){$(".aplayer").length?($(".aplayer-miniswitcher button").on("click",function(){$(".aplayer-list").addClass("aplayer-list-hide"),$(".aplayer").hasClass("aplayer-narrow")?$("#player_back").addClass("show"):$("#player_back").removeClass("show")}),$("#player_back").on("click",function(){$(".aplayer-list").hasClass("aplayer-list-hide")?$(".aplayer").hasClass("aplayer-narrow")||$(".aplayer-miniswitcher button").click():$(".aplayer-list").addClass("aplayer-list-hide")})):setTimeout(util.AplayerInteraction,500)},getUmami:{OnlineUser:async function(){$.get({url:store.Umami.apiurl+"active",headers:store.Umami.headers,success:function(t){store.Umami.count_online.update(t.x),store.Umami.count_online2.update(t.x)},error:function(){setTimeout(util.getUmami.OnlineUser,5e3)},timeout:function(){setTimeout(util.getUmami.OnlineUser,5e3)}})},GetEvents:async function(){let t=(new Date).getTime();$.get({url:store.Umami.apiurl+"metrics?startAt=1691596800000&endAt="+t+"&type=event",headers:store.Umami.headers,success:function(t){for(s=0;"Study"!=t[s].x&&null!=t[s+1];)s++;store.Umami.count_studytimes.update(t[s].y)},error:function(){setTimeout(util.getUmami.GetEvents,5e3)},timeout:function(){setTimeout(util.getUmami.GetEvents,5e3)}})},GetVV:async function(){let t=(new Date).getTime();$.get({url:store.Umami.apiurl+"stats?startAt=1691596800000&endAt="+t,headers:store.Umami.headers,success:function(t){store.Umami.count_visitor.update(t.visitors.value)},error:function(){setTimeout(util.getUmami.GetVV,5e3)},timeout:function(){setTimeout(util.getUmami.GetVV,5e3)}})},GetAll:async function(){this.OnlineUser(),this.GetEvents(),this.GetVV()}},initUmami:async function(){const t={useGrouping:!1};let e=new countUp.CountUp("umami_value_onlineuser",0,t),i=new countUp.CountUp("umami_value_onlineuser2",0,t),n=new countUp.CountUp("umami_value_studytimes",0,t),o=new countUp.CountUp("umami_value_visitors",0,t);const s="b91d816b-91e7-4974-ba3d-ccb61dbecfd6",u="https://umami.wenqi.icu/api/websites/"+s+"/",r={Authorization:"Bearer EJfpKblh2tLICYqBUDDs2eA/vd41CeoMtZpsZhrM5W6YkUyCJH/Dg64XEZp83nCVlIqgr8E2+oEeHL8HRSOf0lMsnHTdvsBsn/3rCSPXDI3kDmMBkG1m38JNIArp6Q1gaX6oZWDTph5H6KESaW4tKIhvwo7uaoFrU7OYDgZUG+YA8x41DZq+8HtAkdhJazAGIvyf2HYFRxZEHNb2tCkm2fwxDekKxnp91PYzZvpY0FoRtjKzq6znHmryoE4J42t8OFHv3g6oz/fFNN6RIXsPn9Nvlvr05qNlCNg5k3Iet+b3AkQPrxSpc2oTsvQPkpgctg1C/fYDs53+S8wMB+B4FtPmxn8vtQZnMw==","Access-Control-Allow-Origin":"*"};Object.defineProperties(store.Umami,{count_online:{value:e},count_online2:{value:i},count_studytimes:{value:n},count_visitor:{value:o},apiurl:{value:u},headers:{value:r}}),this.getUmami.OnlineUser(),this.getUmami.GetEvents(),this.getUmami.GetVV()},study:function(){$(".aplayer-play").trigger("click"),$("#scene_top").fadeOut(300,"linear"),$("#scene_learning").fadeIn(300,"linear"),$("#bt_rest").fadeIn(300,"linear"),$("video").trigger("play"),this.videoresize(),this.Tips.init(),this.timerecord.start(),$("#bt_stop").on("click",function(){util.timerecord.stop(),util.Tips.stop(),$(".aplayer-pause").trigger("click"),$("#scene_top").fadeIn(300,"linear"),$("#scene_learning").fadeOut(300,"linear"),$("#bt_rest").fadeOut(300,"linear"),$("#rest").fadeOut(300,"linear"),$("#rest_cover").fadeOut(300,"linear"),lauched=0})},timerecord:{start:function(){clearInterval(time),clearInterval(resttime),recorded||(hour=minutes=seconds=rhour=rminutes=rseconds=0,$("#time").text(seconds+"秒钟了"),$("#resttime").text(rseconds+"秒钟了"),recorded=1),util.timer()},stop:function(){if(clearInterval(time),clearInterval(resttime),recorded){var t=h=0;for(sumseconds+=seconds;sumseconds>=60;)t++,sumseconds-=60;for(summinutes=summinutes+minutes+t;summinutes>=60;)h++,summinutes-=60;sumhour=sumhour+hour+h,recorded=0,util.writestoragetime()}},pause:function(){clearInterval(time),clearInterval(resttime),util.resttimer()}},initWorldTimer:function(){wtime=setInterval(function(){var t=new Date,e=m=h=0;h=t.getHours(),m=t.getMinutes(),e=t.getSeconds(),t.getHours()<10&&(h="0"+t.getHours()),t.getMinutes()<10&&(m="0"+t.getMinutes()),t.getSeconds()<10&&(e="0"+t.getSeconds()),$("#worldtime").text(h+"时"+m+"分"+e+"秒"),2==document.querySelector("video").readyState&&$("video").trigger("load"),document.querySelector("video").paused&&$("video").trigger("play")},1e3)},timer:function(){var t=sDate=pastmDate=mDate=pasthDate=hDate=0;time=setInterval(function(){var e=$("#time"),i=$("#studytime"),n=new Date;sDate=n.getSeconds(),mDate=n.getMinutes(),hDate=n.getHours(),(sDate-t>=1||mDate-pastmDate>=1||hDate-pasthDate>=1)&&seconds++,60==seconds&&(minutes++,seconds=0),60==minutes&&(hour++,minutes=0),"0"==minutes&&"0"==hour?e.text(seconds+"秒钟啦！继续加油吧！"):"0"!=hour?e.text(hour+"小时"+minutes+"分钟"+seconds+"秒啦！好厉害！！！"):e.text(minutes+"分钟"+seconds+"秒啦！超棒！"),"0"==minutes&&"0"==hour?i.text(seconds+"秒钟"):"0"!=hour?i.text(hour+"小时"+minutes+"分钟"+seconds+"秒"):i.text(minutes+"分钟"+seconds+"秒"),t=sDate,pastmDate=mDate,pasthDate=hDate},1e3)},resttimer:function(){var t=sDate=pastmDate=mDate=pasthDate=hDate=0;resttime=setInterval(function(){var e=$("#resttime"),i=new Date;sDate=i.getSeconds(),mDate=i.getMinutes(),hDate=i.getHours(),(sDate-t>=1||mDate-pastmDate>=1||hDate-pasthDate>=1)&&rseconds++,60==rseconds&&(rminutes++,rseconds=0),60==rminutes&&(rhour++,rminutes=0),"0"==rminutes&&"0"==rhour?e.text(rseconds+"秒钟了"):"0"!=rhour?e.text(rhour+"小时"+rminutes+"分钟"+rseconds+"秒了"):e.text(rminutes+"分钟"+rseconds+"秒了"),t=sDate,pastmDate=mDate,pasthDate=hDate},1e3)},readstoragetime:function(){"GetDAZE"==localStorage.getItem("study")&&(sumhour=parseInt("0x"+localStorage.getItem("studyh")),summinutes=parseInt("0x"+localStorage.getItem("studym")),sumseconds=parseInt("0x"+localStorage.getItem("studys")),"0"==summinutes&&"0"==sumhour?$("#sumtime").text(sumseconds+"秒钟了"):"0"!=sumhour?$("#sumtime").text(sumhour+"小时"+summinutes+"分钟"+sumseconds+"秒了"):$("#sumtime").text(summinutes+"分钟"+sumseconds+"秒了"))},writestoragetime:function(){localStorage.setItem("study","GetDAZE"),localStorage.setItem("studyh",sumhour.toString(16)),localStorage.setItem("studym",summinutes.toString(16)),localStorage.setItem("studys",sumseconds.toString(16)),util.readstoragetime()},addVisibilityListener:function(){document.addEventListener("visibilitychange",function(){recorded&&(util.checkStrictMode()&&!lauched||2==lauched)&&("hidden"===document.visibilityState&&($("#bt_rest").trigger("click"),document.title="摸鱼中..."),"visible"===document.visibilityState&&(document.title="STUDY WITH MIKU"))})},checkStrictMode:function(){let t=localStorage.getItem("conf_strict")-"0";return t},initStrictMode:function(){null==util.checkStrictMode()?localStorage.setItem("conf_strict",0):util.checkStrictMode()&&($("#btt_strict")[0].innerText="严格模式(离开页面自动停止): 开")},switchStrictMode:function(){util.checkStrictMode()?($("#btt_strict")[0].innerText="严格模式(离开页面自动停止): 关",localStorage.setItem("conf_strict",0)):($("#btt_strict")[0].innerText="严格模式(离开页面自动停止): 开",localStorage.setItem("conf_strict",1))},initTips:function(t){switch(util.readTipsconf(t)){case 1:localStorage.setItem("conf_tips_"+t,1);break;case 2:localStorage.setItem("conf_tips_"+t,2),$("#"+t+"_mode").text("常驻");break;case 3:localStorage.setItem("conf_tips_"+t,0),$("#"+t+"_mode").text("隐藏")}$("#btt_mode_"+t).on("click",function(){util.switchTipsconf(t)})},readTipsconf:function(t){let e=localStorage.getItem("conf_tips_"+t)-"0";return e},switchTipsconf:function(t){3==util.readTipsconf(t)?(localStorage.setItem("conf_tips_"+t,1),$("#"+t+"_mode").text("轮换")):1==util.readTipsconf(t)&&"hitokoto"!=t?(localStorage.setItem("conf_tips_"+t,2),$("#"+t+"_mode").text("常驻")):(localStorage.setItem("conf_tips_"+t,3),$("#"+t+"_mode").text("隐藏"))},Tips:{init:function(){$(".tips").html("").prepend('<p class="attention">开始认真学习/工作吧！</p>').append('<p class="hitokoto" style="display: none;">"<hitokoto id="hitokoto">获取一言中...(*/ω＼*)</hitokoto>"</p>'),2==util.readTipsconf("worldtime")?($(".attention").after('<p class="worldtime" style="display: none;">现在时间是:<text id="worldtime">0分钟</text>...</p>'),2==util.readTipsconf("studytime")?$(".worldtime").after('<p class="studytime" style="display: none;">已经学习<text id="studytime">0分钟</text>了呢...</p>'):$(".tips").append('<p class="studytime" style="display: none;">已经学习<text id="studytime">0分钟</text>了呢...</p>')):(2==util.readTipsconf("studytime")?$(".attention").after('<p class="studytime" style="display: none;">已经学习<text id="studytime">0分钟</text>了呢...</p>'):$(".tips").append('<p class="studytime" style="display: none;">已经学习<text id="studytime">0分钟</text>了呢...</p>'),$(".tips").append('<p class="worldtime" style="display: none;">现在时间是:<text id="worldtime">0分钟</text>...</p>')),util.Tips.start()},start:function(){attentionout=setTimeout(function(){$(".attention").fadeOut(200,"linear"),1==util.readTipsconf("hitokoto")?tipsrollnow="hitokoto":1==util.readTipsconf("worldtime")?tipsrollnow="worldtime":1==util.readTipsconf("studytime")&&(tipsrollnow="studytime"),2==util.readTipsconf("worldtime")&&$(".worldtime").fadeIn(300,"linear"),2==util.readTipsconf("studytime")&&$(".studytime").fadeIn(300,"linear"),util.Tips.roll()},6e3)},roll:function(){if(1==util.readTipsconf(tipsrollnow)){if("hitokoto"==tipsrollnow){async function t(){const t=document.querySelector("#hitokoto");t.innerText="获取一言中...(*/ω＼*)";const e=await fetch("https://v1.hitokoto.cn/?c=i&c=k&max_length=10"),{hitokoto:i}=await e.json();t.innerText=i}1==util.readTipsconf("worldtime")?tipsrollnow="worldtime":1==util.readTipsconf("studytime")&&(tipsrollnow="studytime"),t(),hitokotoin=setTimeout(function(){$(".hitokoto").fadeIn(300,"linear")},1300),hitokotoout=setTimeout(function(){$(".hitokoto").fadeOut(300,"linear")},8600)}else"worldtime"==tipsrollnow?(1==util.readTipsconf("studytime")?tipsrollnow="studytime":1==util.readTipsconf("hitokoto")&&(tipsrollnow="hitokoto"),worldtimein=setTimeout(function(){$(".worldtime").fadeIn(300,"linear")},1300),worldtimeout=setTimeout(function(){$(".worldtime").fadeOut(300,"linear")},8600)):(1==util.readTipsconf("hitokoto")?tipsrollnow="hitokoto":1==util.readTipsconf("worldtime")&&(tipsrollnow="worldtime"),studytimein=setTimeout(function(){$(".studytime").fadeIn(300,"linear")},1300),studytimeout=setTimeout(function(){$(".studytime").fadeOut(300,"linear")},8600));rolltimeout=setTimeout(function(){util.Tips.roll()},10900)}},stop:function(){clearTimeout(rolltimeout),clearTimeout(hitokotoin),clearTimeout(hitokotoout),clearTimeout(worldtimein),clearTimeout(worldtimeout),clearTimeout(studytimein),clearTimeout(studytimeout),clearInterval(attentionout),$(".studytime").fadeOut(300,"linear"),$(".hitokoto").fadeOut(300,"linear"),$(".worldtime").fadeOut(300,"linear"),setTimeout(function(){$(".attention").fadeIn(300,"linear")},300)}},videoresize:function(){var t=$(window).width(),e=$(window).height();$("video").width(),$("video").height();.5625*t>=e?$("video").css("height","auto").css("width",t).css("top",e/2-$("video").height()/2).css("left","0"):$("video").css("height",e).css("width","auto").css("left",t/2-$("video").width()/2).css("top","0")},fullscreen:function(t){util.checkFullscreen()?document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.exitFullscreen&&document.exitFullscreen():(t?"string"==typeof t&&(t=document.getElementById(t)):t=document.body,t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():t.requestFullscreen&&t.requestFullscreen()),util.checkFullscreen()?$("#bt_fs").text("∷全屏"):$("#bt_fs").text("∷退出全屏")},checkFullscreen:function(){return!!(document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.fullscreenElement)}},hour=minutes=seconds=rhour=rminutes=rseconds=recorded=sumhour=summinutes=sumseconds=tipstype=rolltimeout=worldtimein=worldtimeout=studytimein=studytimeout=hitokotoin=hitokotoout=attentionout=tipsrollnow=lauched=0;console.log(`\n %c Study With Miku ${version} %c 在干什么呢(・∀・(・∀・(・∀・*) \n`,"color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0; color: #000");